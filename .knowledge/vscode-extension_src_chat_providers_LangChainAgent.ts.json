{"is_source_file": true, "format": "TypeScript", "description": "This TypeScript source file defines the LangChainAgent class, which implements a minimal chat agent that can interface with file system tools such as read, write, and diff operations via MCP commands. It is designed for integration within a VSCode extension, providing an interface for command-based file manipulation in response to user messages.", "external_files": ["../ChatService", "../../commands/mcpTools"], "external_methods": ["ensureMcpCommandsRegistered", "mcpReadFile", "mcpWriteFile", "mcpDiffApply", "mcpProduceDiff"], "published": ["LangChainAgent"], "classes": [{"name": "LangChainAgent", "description": "A lightweight orchestrator that streams reasoning based on user messages and can perform read, write, and diff file operations through MCP commands, optionally guarded by user prompts and conditions."}], "methods": [{"name": "stream( stream", "description": "Processes user messages to decide whether to perform read, write, or diff operations on files, streams reasoning steps and tool outputs back to the UI, and handles cancellation.", "scope": "LangChainAgent", "scopeKind": "class"}, {"name": "constructor() { constructor", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}], "calls": ["mcpReadFile", "mcpProduceDiff", "mcpDiffApply", "mcpWriteFile"], "search-terms": ["LangChainAgent", "MCP commands", "VSCode extension chat provider", "file read write diff"], "state": 2, "file_id": 28, "knowledge_revision": 126, "git_revision": "09174c7c6386acc5d1eccd8badec153825396517", "revision_history": [{"76": ""}, {"93": "8d2848e0c0dd6eb902653875055f8d3ab464ce16"}, {"108": "c187648fc404af9ec12e4741c1fd672c22348bed"}, {"126": "09174c7c6386acc5d1eccd8badec153825396517"}], "ctags": [{"_type": "tag", "name": "LangChainAgent", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^export class LangChainAgent implements ChatProvider {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "apply", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^          const apply = await mcpDiffApply(pathMatch, proposed || '');$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "chunks", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const chunks: string[] = [];$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  constructor() {$/", "language": "TypeScript", "kind": "method", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^          const content = await mcpReadFile(pathMatch);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "enableDiff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly enableDiff: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "enableRead", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly enableRead: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "enableWrite", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly enableWrite: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "frequencyPenalty", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly frequencyPenalty: number | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "full", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^        const full = chunks.join('');$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsDiff = this.enableDiff && \\/(diff|patch)\\\\b\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsRead = this.enableRead && \\/(read|show|open)\\\\s+file\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsWrite = this.enableWrite && \\/(write|save|replace)\\\\s+file\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "legacyCopilo", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const legacyCopilo = vscode.workspace.getConfiguration('teCopilo');$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.constructor", "scopeKind": "method"}, {"_type": "tag", "name": "lower", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const lower = userContent.toLowerCase();$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "maxTokens", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly maxTokens: number | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "maybePathInfo", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const maybePathInfo = pathMatch ? `Target path: ${pathMatch}\\\\n` : 'No explicit file path de/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^          const ok = await mcpWriteFile(pathMatch, textToWrite, { append: true });$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "oldCfg", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const oldCfg = vscode.workspace.getConfiguration('kaviaChat');$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.constructor", "scopeKind": "method"}, {"_type": "tag", "name": "p", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^        for (const p of parts) {$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "parts", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^        const parts = full.split(\\/(\\\\s+)\\/);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "pathMatch", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const pathMatch = userContent.match(\\/[\"'`](.+?\\\\.[a-zA-Z0-9]+)[\"'`]\\/)?.[1] ||$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "presencePenalty", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly presencePenalty: number | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "primary", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const primary = vscode.workspace.getConfiguration('teCopilot');$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.constructor", "scopeKind": "method"}, {"_type": "tag", "name": "proposed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^          const proposed = await mcpProduceDiff(pathMatch);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "push", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const push = (s: string) => chunks.push(s);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "stream", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  stream($/", "language": "TypeScript", "kind": "method", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "systemPrompt", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly systemPrompt: string | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "temperature", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly temperature: number | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "textToWrite", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^          const textToWrite = `\\/\\/ Updated by LangChainAgent at ${new Date().toISOString()}\\\\n`/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "topP", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^  private readonly topP: number | undefined;$/", "language": "TypeScript", "kind": "property", "scope": "LangChainAgent", "scopeKind": "class"}, {"_type": "tag", "name": "userContent", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const userContent = params.messages.find(m => m.role === 'user')?.content ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "wantsDiff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsDiff = this.enableDiff && \\/(diff|patch)\\\\b\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "wantsRead", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsRead = this.enableRead && \\/(read|show|open)\\\\s+file\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}, {"_type": "tag", "name": "wantsWrite", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/LangChainAgent.ts", "pattern": "/^    const wantsWrite = this.enableWrite && \\/(write|save|replace)\\\\s+file\\/i.test(userContent);$/", "language": "TypeScript", "kind": "constant", "scope": "LangChainAgent.stream", "scopeKind": "method"}], "hash": "2cd477bff9e1f437814259d486b3c920", "format-version": 4, "code-base-name": "frontend", "filename": "vscode-extension/src/chat/providers/LangChainAgent.ts", "fields": [{"name": "private readonly enableDiff: boolean;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly enableRead: boolean;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly enableWrite: boolean;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly frequencyPenalty: number | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly maxTokens: number | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly presencePenalty: number | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly systemPrompt: string | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly temperature: number | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly topP: number | undefined;", "scope": "LangChainAgent", "scopeKind": "class", "description": "unavailable"}]}