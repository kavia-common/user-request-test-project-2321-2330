{"is_source_file": true, "format": "TypeScript", "description": "This file provides command registration and file manipulation utilities for a VSCode extension related to MCP-like tools, including reading, writing, diff producing, and applying diffs to files within the workspace.", "external_files": ["vscode", "path", "fs/promises"], "external_methods": ["vscode.commands.registerCommand", "vscode.window.showWarningMessage", "vscode.window.showErrorMessage", "vscode.window.activeTextEditor", "vscode.workspace.workspaceFolders", "fs.stat", "fs.readFile", "fs.writeFile", "fs.appendFile", "fs.mkdir"], "published": ["ensureMcpCommandsRegistered", "mcpReadFile", "mcpWriteFile", "mcpProduceDiff", "mcpDiffApply"], "classes": [], "methods": [{"name": "export function ensureMcpCommandsRegistered() { ensureMcpCommandsRegistered", "description": "Ensures that MCP-related commands are registered exactly once in the VSCode extension context.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpReadFile(filePath?: string): Promise<string | undefined> { mcpReadFile", "description": "Reads the contents of a file from the current workspace with safety checks and error handling.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpWriteFile(filePath?: string, content?: string, options?: { append?: boo/ mcpWriteFile", "description": "Writes or appends content to a specified file after user confirmation, handling errors and directory creation.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpProduceDiff(filePath?: string): Promise<string | undefined> { mcpProduceDiff", "description": "Produces a synthetic diff header for a file, inserting a timestamped header at the top.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpDiffApply(filePath?: string, diff?: string): Promise<boolean> { mcpDiffApply", "description": "Applies a synthetic diff (adds a header) to a file after user confirmation.", "scope": "", "scopeKind": ""}, {"name": "async function resolveWorkspacePath(filePath?: string): Promise<string | undefined> { resolveWorkspacePath", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["resolveWorkspacePath", "fs.stat", "fs.readFile", "fs.writeFile", "fs.appendFile", "vscode.commands.registerCommand", "vscode.window.showWarningMessage", "vscode.window.showErrorMessage"], "search-terms": ["commands registration", "mcp file utils", "VSCode extension file operations", "diff and patch", "workspace file handling", "MCP-like tools"], "state": 2, "file_id": 29, "knowledge_revision": 94, "git_revision": "8d2848e0c0dd6eb902653875055f8d3ab464ce16", "revision_history": [{"78": ""}, {"94": "8d2848e0c0dd6eb902653875055f8d3ab464ce16"}], "ctags": [{"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpWriteFile", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = path.join(folders[0].uri.fsPath, filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const after = before.startsWith(header) ? before : header + before;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const after = before.startsWith(header) ? before : header + before;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "allowed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const allowed = folders.some(f => filePath.startsWith(f.uri.fsPath));$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "allowed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const allowed = abs.startsWith(folders[0].uri.fsPath);$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const before = (await fs.readFile(abs, 'utf-8').catch(() => '')) ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const before = (await fs.readFile(abs, 'utf-8').catch(() => '')) ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "buf", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const buf = await fs.readFile(abs, 'utf-8');$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}, {"_type": "tag", "name": "diff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const diff =$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "editor", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const editor = vscode.window.activeTextEditor;$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "ensureMcpCommandsRegistered", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export function ensureMcpCommandsRegistered() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "folders", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const folders = vscode.workspace.workspaceFolders;$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "header", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const header = `\\/\\/ Updated by KAVIA Chat at ${new Date().toISOString()}\\\\n`;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "header", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const header = `\\/\\/ Updated by Te-copilot Chat at ${new Date().toISOString()}\\\\n`;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "mcpDiffApply", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpDiffApply(filePath?: string, diff?: string): Promise<boolean> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpProduceDiff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpProduceDiff(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpReadFile", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpReadFile(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpWriteFile", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpWriteFile(filePath?: string, content?: string, options?: { append?: boo/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const ok = await vscode.window.showWarningMessage($/", "language": "TypeScript", "kind": "constant", "scope": "mcpWriteFile", "scopeKind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const ok = await vscode.window.showWarningMessage($/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "registered", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^let registered = false;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "resolveWorkspacePath", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^async function resolveWorkspacePath(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "stat", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const stat = await fs.stat(abs).catch(() => null);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}], "hash": "0e563af2286cbaa0c5bf3cde77b5edd4", "format-version": 4, "code-base-name": "frontend", "filename": "vscode-extension/src/commands/mcpTools.ts", "fields": [{"name": "let registered = false;", "scope": "", "scopeKind": "", "description": "unavailable"}]}