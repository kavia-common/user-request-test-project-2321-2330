{"is_source_file": true, "format": "TypeScript", "description": "This file provides command registration and utility functions for file operations (read, write, diff, apply diff) as part of a VSCode extension, specifically related to 'MCP'-like tools within a chat context.", "external_files": ["vscode", "path", "fs/promises"], "external_methods": ["vscode.commands.registerCommand", "vscode.window.showWarningMessage", "vscode.window.showErrorMessage", "vscode.workspace.workspaceFolders", "vscode.window.activeTextEditor", "vscode.window.activeTextEditor.document.uri.fsPath", "fs.stat", "fs.readFile", "fs.writeFile", "fs.appendFile", "fs.mkdir", "fs/promises"], "published": ["ensureMcpCommandsRegistered", "mcpReadFile", "mcpWriteFile", "mcpProduceDiff", "mcpDiffApply"], "classes": [], "methods": [{"name": "export function ensureMcpCommandsRegistered() { ensureMcpCommandsRegistered", "description": "Registers MCP-related VSCode commands if not already registered, ensuring singleton behavior.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpReadFile(filePath?: string): Promise<string | undefined> { mcpReadFile", "description": "Reads the contents of a specified file within the workspace, with safety checks and user feedback.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpWriteFile(filePath?: string, content?: string, options?: { append?: boo/ mcpWriteFile", "description": "Writes or appends to a specified file within the workspace, with user confirmation and safety checks.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpProduceDiff(filePath?: string): Promise<string | undefined> { mcpProduceDiff", "description": "Generates a synthetic diff for a file, adding a header comment indicating update time.", "scope": "", "scopeKind": ""}, {"name": "export async function mcpDiffApply(filePath?: string, diff?: string): Promise<boolean> { mcpDiffApply", "description": "Applies a simple synthetic diff by prepending a header comment, with user confirmation.", "scope": "", "scopeKind": ""}, {"name": "async function resolveWorkspacePath(filePath?: string): Promise<string | undefined> { resolveWorkspacePath", "description": "Resolves a provided file path relative to workspace folders or current editor, ensuring it\u2019s within workspace.", "scope": "", "scopeKind": ""}], "calls": ["vscode.commands.registerCommand", "vscode.window.showWarningMessage", "vscode.window.showErrorMessage", "fs.stat", "fs.readFile", "fs.writeFile", "fs.appendFile", "fs.mkdir"], "search-terms": ["registerCommand", "mcpReadFile", "diff", "applyDiff", "workspace", "file operations", "VSCode extension"], "state": 2, "file_id": 29, "knowledge_revision": 78, "git_revision": "", "ctags": [{"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpWriteFile", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = await resolveWorkspacePath(filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "abs", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const abs = path.join(folders[0].uri.fsPath, filePath);$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const after = before.startsWith(header) ? before : header + before;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "after", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const after = before.startsWith(header) ? before : header + before;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "allowed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const allowed = folders.some(f => filePath.startsWith(f.uri.fsPath));$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "allowed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const allowed = abs.startsWith(folders[0].uri.fsPath);$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const before = (await fs.readFile(abs, 'utf-8').catch(() => '')) ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "before", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const before = (await fs.readFile(abs, 'utf-8').catch(() => '')) ?? '';$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "buf", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const buf = await fs.readFile(abs, 'utf-8');$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}, {"_type": "tag", "name": "diff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const diff =$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "editor", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const editor = vscode.window.activeTextEditor;$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "ensureMcpCommandsRegistered", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export function ensureMcpCommandsRegistered() {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "folders", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const folders = vscode.workspace.workspaceFolders;$/", "language": "TypeScript", "kind": "constant", "scope": "resolveWorkspacePath", "scopeKind": "function"}, {"_type": "tag", "name": "header", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const header = `\\/\\/ Updated by KAVIA Chat at ${new Date().toISOString()}\\\\n`;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "header", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const header = `\\/\\/ Updated by KAVIA Chat at ${new Date().toISOString()}\\\\n`;$/", "language": "TypeScript", "kind": "constant", "scope": "mcpProduceDiff", "scopeKind": "function"}, {"_type": "tag", "name": "mcpDiffApply", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpDiffApply(filePath?: string, diff?: string): Promise<boolean> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpProduceDiff", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpProduceDiff(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpReadFile", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpReadFile(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "mcpWriteFile", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^export async function mcpWriteFile(filePath?: string, content?: string, options?: { append?: boo/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const ok = await vscode.window.showWarningMessage($/", "language": "TypeScript", "kind": "constant", "scope": "mcpWriteFile", "scopeKind": "function"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^  const ok = await vscode.window.showWarningMessage($/", "language": "TypeScript", "kind": "constant", "scope": "mcpDiffApply", "scopeKind": "function"}, {"_type": "tag", "name": "registered", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^let registered = false;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "resolveWorkspacePath", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^async function resolveWorkspacePath(filePath?: string): Promise<string | undefined> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "stat", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/commands/mcpTools.ts", "pattern": "/^    const stat = await fs.stat(abs).catch(() => null);$/", "language": "TypeScript", "kind": "constant", "scope": "mcpReadFile", "scopeKind": "function"}], "hash": "5591f09d1969dfe127ba8f9cf96d9291", "format-version": 4, "code-base-name": "frontend", "filename": "vscode-extension/src/commands/mcpTools.ts", "fields": [{"name": "let registered = false;", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"78": ""}]}