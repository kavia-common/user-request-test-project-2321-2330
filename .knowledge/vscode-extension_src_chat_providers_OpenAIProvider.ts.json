{"is_source_file": true, "format": "TypeScript", "description": "This file defines the OpenAIProvider class, which implements the ChatProvider interface for streaming chat completions from an OpenAI-compatible API. It manages API calls, streaming responses, cancellation, and message formatting.", "external_files": ["../ChatService"], "external_methods": ["vscode.CancellationToken.onCancellationRequested"], "published": ["OpenAIProvider"], "classes": [{"name": "OpenAIProvider", "description": "Provides streaming chat completions via OpenAI-compatible REST API with support for streaming, cancellation, and model selection."}], "methods": [{"name": "private mapMessages(messages: ChatMessage[]) { mapMessages", "description": "Converts provider-agnostic chat messages to OpenAI's expected message format.", "scope": "OpenAIProvider", "scopeKind": "class"}, {"name": "stream( stream", "description": "Streams chat completions from the API, calling onDelta with incremental responses and onDone when complete. Supports cancellation via vscode.CancellationToken.", "scope": "OpenAIProvider", "scopeKind": "class"}, {"name": "constructor(opts: { apiKey: string; baseURL?: string; model?: string }) { constructor", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}], "calls": ["fetch", "reader.read", "reader.cancel", "onCancellationRequested", "onDelta", "onDone"], "search-terms": ["OpenAIProvider", "streaming chat completions", "SSE fetch stream", "CancellationToken", "chat API", "stream method", "vscode extension"], "state": 2, "file_id": 26, "knowledge_revision": 62, "git_revision": "", "ctags": [{"_type": "tag", "name": "OpenAIProvider", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^export class OpenAIProvider implements ChatProvider {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "apiKey", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly apiKey: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "baseURL", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly baseURL: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const body = {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  constructor(opts: { apiKey: string; baseURL?: string; model?: string }) {$/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "controller", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const controller = new AbortController();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^            const data = trimmed.replace(\\/^data:\\\\s*\\/, '');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "decoder", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const decoder = new TextDecoder('utf-8');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "delta", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^              const delta = json?.choices?.[0]?.delta?.content;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "done", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const { done, value } = await reader.read();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^              const json = JSON.parse(data);$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "line", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          for (const line of lines) {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "lines", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const lines = buffer.split('\\\\n');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "mapMessages", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private mapMessages(messages: ChatMessage[]) {$/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^      messages: this.mapMessages(params.messages),$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "model", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const model = params.model || this.model;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "model", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly model: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "reader", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const reader = res.body.getReader();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const res = await fetch(url, {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "signal", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const signal = controller.signal;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "stream", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  stream($/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "sub", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const sub = token.onCancellationRequested(() => {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const text = await res.text().catch(() => '');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "trimmed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^            const trimmed = line.trim();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const url = `${this.baseURL}\\/chat\\/completions`;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const { done, value } = await reader.read();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}], "hash": "c8eb94648b19c1c9b0eaa7e02c878d7b", "format-version": 4, "code-base-name": "frontend", "filename": "vscode-extension/src/chat/providers/OpenAIProvider.ts", "fields": [{"name": "private readonly apiKey: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly baseURL: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly model: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"62": ""}]}