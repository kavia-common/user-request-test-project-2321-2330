{"is_source_file": true, "format": "TypeScript", "description": "This file defines the OpenAIProvider class, which implements chat streaming functionality using the OpenAI-compatible REST API. It handles streaming responses via Server-Sent Events (SSE), supports cancellation, and allows configuration of model and API URL. The class conforms to the ChatProvider interface and manages communication with the API to facilitate chat completions.", "external_files": ["../ChatService"], "external_methods": ["vscode.CancellationToken.onCancellationRequested", "fetch", "reader.getReader", "reader.cancel", "TextDecoder.decode", "JSON.parse", "console.error"], "published": ["OpenAIProvider"], "classes": [{"name": "OpenAIProvider", "description": "A class that streams chat completions using the OpenAI-compatible REST API, supporting streaming, cancellation, and configurable options."}], "methods": [{"name": "constructor(opts: { apiKey: string; baseURL?: string; model?: string }) { constructor", "description": "Initializes the OpenAIProvider with API key, optional base URL, and model.", "scope": "OpenAIProvider", "scopeKind": "class"}, {"name": "private mapMessages(messages: ChatMessage[]) { mapMessages", "description": "Converts generic chat messages to OpenAI-specific message format.", "scope": "OpenAIProvider", "scopeKind": "class"}, {"name": "stream( stream", "description": "Starts streaming chat completion data from the API, handling SSE with cancellation support.", "scope": "OpenAIProvider", "scopeKind": "class"}], "calls": ["fetch", "reader.read", "reader.cancel", "JSON.parse", "onDelta", "onDone", "token.onCancellationRequested"], "search-terms": ["OpenAIProvider", "chat/completions", "streaming", "sse", "CancellationToken", "TypeScript class"], "state": 2, "file_id": 26, "knowledge_revision": 135, "git_revision": "2ca3b6d061148df6a9e1f4fc65320bf3ad24ab7a", "revision_history": [{"62": ""}, {"135": "2ca3b6d061148df6a9e1f4fc65320bf3ad24ab7a"}], "ctags": [{"_type": "tag", "name": "OpenAIProvider", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^export class OpenAIProvider implements ChatProvider {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "apiKey", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly apiKey: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const base = (opts.baseURL ?? '').trim();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.constructor", "scopeKind": "method"}, {"_type": "tag", "name": "baseURL", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly baseURL: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const body = {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "constructor", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  constructor(opts: { apiKey: string; baseURL?: string; model?: string }) {$/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "controller", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const controller = new AbortController();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^            const data = trimmed.replace(\\/^data:\\\\s*\\/, '');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "decoder", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const decoder = new TextDecoder('utf-8');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "delta", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^              const delta = json?.choices?.[0]?.delta?.content;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "done", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const { done, value } = await reader.read();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "json", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^              const json = JSON.parse(data);$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "line", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          for (const line of lines) {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "lines", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const lines = buffer.split('\\\\n');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "mapMessages", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private mapMessages(messages: ChatMessage[]) {$/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "messages", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^      messages: this.mapMessages(params.messages),$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "model", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const model = params.model || this.model;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "model", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  private readonly model: string;$/", "language": "TypeScript", "kind": "property", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "reader", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const reader = res.body.getReader();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^        const res = await fetch(url, {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "signal", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const signal = controller.signal;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "stream", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^  stream($/", "language": "TypeScript", "kind": "method", "scope": "OpenAIProvider", "scopeKind": "class"}, {"_type": "tag", "name": "sub", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const sub = token.onCancellationRequested(() => {$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "text", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const text = await res.text().catch(() => '');$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "trimmed", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^            const trimmed = line.trim();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^    const url = `${this.baseURL}\\/chat\\/completions`;$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/user-request-test-project-2321-2330/vscode-extension/src/chat/providers/OpenAIProvider.ts", "pattern": "/^          const { done, value } = await reader.read();$/", "language": "TypeScript", "kind": "constant", "scope": "OpenAIProvider.stream", "scopeKind": "method"}], "hash": "a86c61b6b29fa5d9b2798f231c6b6d0a", "format-version": 4, "code-base-name": "frontend", "filename": "vscode-extension/src/chat/providers/OpenAIProvider.ts", "fields": [{"name": "private readonly apiKey: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly baseURL: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly model: string;", "scope": "OpenAIProvider", "scopeKind": "class", "description": "unavailable"}]}